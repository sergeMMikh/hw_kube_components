# Домашнее задание к занятию «Компоненты Kubernetes»- Михалёв Сергей

### Цель задания

Рассчитать требования к кластеру под проект

------

### Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

----

**Решение**

Необходимые ресурсы по компонентам

***База данных*** (отказоустойчивая)

Тип: StatefulSet (для сохранения состояния и отказоустойчивости).

- Ресурсы:
  - Память: 4 ГБ на под.
  - CPU: 1 ядро на под.
  - Количество копий: 3.
- Хранилище: Персистентное (PersistentVolume) для каждого пода.
- Примерное хранилище: 20–50 ГБ на каждую реплику (зависит от нагрузки и данных).
- Сетевые ресурсы: Headless Service для доступа к каждому поду по имени.

***Кеш*** (отказоустойчивый)

Тип: StatefulSet (сохранение состояния в случае перезапуска).
- Ресурсы:
  - Память: 4 ГБ на под.
  - CPU: 1 ядро на под.
  - Количество копий: 3.
- Сетевые ресурсы: Headless Service.
- Примечание: Если используется Redis или Memcached, можно включить репликацию для отказоустойчивости.

***Фронтенд***

Тип: Deployment (статическое содержимое не требует состояния).
- Ресурсы:
  - Память: 50 МБ на под.
  - CPU: 0.2 ядра на под.
  - Количество копий: 5.
- Сетевые ресурсы: Service (NodePort или LoadBalancer для доступа снаружи) или Ingress для маршрутизации запросов.

***Бекенд***

Тип: Deployment (масштабируемое приложение).
- Ресурсы:
  - Память: 600 МБ на под.
  - CPU: 1 ядро на под.
  - Количество копий: 10.
- Сетевые ресурсы: ClusterIP Service для связи с фронтендом или другими компонентами (например, базой данных и кешем).


***Ресурсы по кластеру***

С учётом всех факторов (ресурсы приложений, резерв ан отказоустойчивость, русурсы служебных задач):

  - Количество нод: 4
  - Параметры каждой ноды: 16 ГБ памяти, 8 ядер CPU.
  - Служебные ресурсы: 2ГБ памяти и 0.5 ядра на ноду2ГБпамятии 0.5 ядра на ноду.

Здесь 0.5 ядра, это не бред, а 50% процессорного времени одного ядра:
```
resources:
  requests:
    cpu: "500m"
    memory: "256Mi"
  limits:
    cpu: "1000m"
    memory: "512Mi"
  ```
Резерв на отказоустойчивость x1.5.

Ресурсы для служебных задач (DNS, мониторинг и т.п.):
  - Служебная память на ноду: 2 ГБ
  - Служебные CPU на ноду: 0.5 ядра